{"ast":null,"code":"// Copyright (c) 2021, Oracle and/or its affiliates.\n\n'use strict';\n\nconst Packet = require('../packets/packet');\nclass AuthNextFactor {\n  constructor(opts) {\n    this.pluginName = opts.pluginName;\n    this.pluginData = opts.pluginData;\n  }\n  toPacket(encoding) {\n    const length = 6 + this.pluginName.length + this.pluginData.length;\n    const buffer = Buffer.allocUnsafe(length);\n    const packet = new Packet(0, buffer, 0, length);\n    packet.offset = 4;\n    packet.writeInt8(0x02);\n    packet.writeNullTerminatedString(this.pluginName, encoding);\n    packet.writeBuffer(this.pluginData);\n    return packet;\n  }\n  static fromPacket(packet, encoding) {\n    packet.readInt8(); // marker\n    const name = packet.readNullTerminatedString(encoding);\n    const data = packet.readBuffer();\n    return new AuthNextFactor({\n      pluginName: name,\n      pluginData: data\n    });\n  }\n}\nmodule.exports = AuthNextFactor;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}